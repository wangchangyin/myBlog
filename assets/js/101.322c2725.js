(window.webpackJsonp=window.webpackJsonp||[]).push([[101],{543:function(a,s,e){"use strict";e.r(s);var n=e(8),t=Object(n.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"docker搭建halo博客"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker搭建halo博客"}},[a._v("#")]),a._v(" docker搭建halo博客")]),a._v(" "),e("p",[a._v("参考：https://blog.csdn.net/weixin_43909881/article/details/105186317")]),a._v(" "),e("h2",{attrs:{id:"一-使用mysql搭建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-使用mysql搭建"}},[a._v("#")]),a._v(" 一.使用mysql搭建")]),a._v(" "),e("p",[a._v("1.下载文件到本地的linux环境")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 下载配置文件到 /data/halo 目录\ncurl -o /data/halo/application.yaml --create-dirs https://dl.halo.run/config/application-template.yaml\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("p",[a._v("2.修改配置文件（可以不修改)")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("vi /data/halo/application.yaml\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("3.下载下来的配置文件默认是使用"),e("strong",[a._v("H2 Database")]),a._v("的，把它改成自己实际使用的，我用的是mysql，配置文件换成mysql，然后修改数据库url和用户名密码，其他的注释掉，端口用默认的8090，可根据自己需要修改，改完如下")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("server:\n  port: 8090\nspring:\n  datasource:\n    type: com.zaxxer.hikari.HikariDataSource\n    # H2 Database 配置，如果你需要使用 MySQL，请注释掉该配置并取消注释 MySQL 的配置。\n    #driver-class-name: org.h2.Driver\n    #url: jdbc:h2:file:~/.halo/db/halo\n    #username: admin\n    #password: 123456\n\n    # MySQL 配置，如果你需要使用 H2Database，请注释掉该配置并取消注释上方 H2Database 的配置。\n    driver-class-name: com.mysql.cj.jdbc.Driver\n    url: jdbc:mysql://xx.xx.xx.xx:3306/halodb?characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true\n    username: root\n    password: root\n    \n  # H2 Database 的控制台相关配置，如果你使用的是 MySQL ，请注释掉下方内容。\n#  h2:\n#    console:\n#      settings:\n#        web-allow-others: false\n#      path: /h2-console\n#      enabled: false\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br"),e("span",{staticClass:"line-number"},[a._v("11")]),e("br"),e("span",{staticClass:"line-number"},[a._v("12")]),e("br"),e("span",{staticClass:"line-number"},[a._v("13")]),e("br"),e("span",{staticClass:"line-number"},[a._v("14")]),e("br"),e("span",{staticClass:"line-number"},[a._v("15")]),e("br"),e("span",{staticClass:"line-number"},[a._v("16")]),e("br"),e("span",{staticClass:"line-number"},[a._v("17")]),e("br"),e("span",{staticClass:"line-number"},[a._v("18")]),e("br"),e("span",{staticClass:"line-number"},[a._v("19")]),e("br"),e("span",{staticClass:"line-number"},[a._v("20")]),e("br"),e("span",{staticClass:"line-number"},[a._v("21")]),e("br"),e("span",{staticClass:"line-number"},[a._v("22")]),e("br"),e("span",{staticClass:"line-number"},[a._v("23")]),e("br"),e("span",{staticClass:"line-number"},[a._v("24")]),e("br")])]),e("p",[a._v("4.下载docker镜像")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sudo docker pull ruibaby/halo\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("5.运行镜像")]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("docker run --rm -it -d --name halo -p 8090:8090  --privileged=true -v /data/halo:/root/.halo ruibaby/halo\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("--rm：系统崩了会自动删除容器")]),a._v(" "),e("p",[a._v("--privileged=true：给挂载文件权限")]),a._v(" "),e("h2",{attrs:{id:"二-使用自带的h2database搭建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-使用自带的h2database搭建"}},[a._v("#")]),a._v(" 二.使用自带的H2Database搭建")]),a._v(" "),e("p",[a._v("经过测试，以及看官方文档，发现不修改配置文件才是最优解，即不使用自建mysql，而是使用内嵌的H2数据库，理由如下：")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("halo可实现数据备份，但自建mysql未来更换服务器，数据备份会比较麻烦，H2备份的话直接导入就可以了，mysql的话需要导出数据表，同时还得备份数据")])]),a._v(" "),e("li",[e("p",[a._v("用内嵌的H2数据库的话，可以选择整站备份，然后在新服务器把导出的压缩文件解压，docker启动的时候挂载上备份的文件夹，启动后就跟原来的博客博客一模一样了，如下图")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200401211621914.png",alt:"在这里插入图片描述"}})])]),a._v(" "),e("li",[e("p",[a._v("由于我的mysql跑在docker中，占用内存较大（400m+…学生机…心疼），而且不太稳定，而H2对halo来说几乎没多大的内存开销（200m+），还不需要再跑个mysql他不香吗~")])])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 下载配置文件到 /data/halo 目录\ncurl -o /data/halo/application.yaml --create-dirs https://dl.halo.run/config/application-template.yaml\nsudo docker pull ruibaby/halo\ndocker run --rm -it -d --name halo -p 8090:8090  --privileged=true -v /data/halo:/root/.halo ruibaby/halo\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br")])])])}),[],!1,null,null,null);s.default=t.exports}}]);