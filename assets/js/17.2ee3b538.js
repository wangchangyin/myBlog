(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{458:function(n,s,a){"use strict";a.r(s);var t=a(8),e=Object(t.a)({},(function(){var n=this,s=n.$createElement,a=n._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("ul",[a("li",[n._v("前缀通过读取本地IP标识不同的实例")]),n._v(" "),a("li",[n._v("generateOrderNo()方法内不需要加锁，因为AtomicInteger内使用是CAS自旋转锁(保证可见性的同时也保证原子性,具体的请自行了解")]),n._v(" "),a("li",[n._v("getLocalIpSuffix()方法内不需要对不为null的逻辑加同步锁(双向校验锁，整体是一种安全的单例模式")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('package com.wcy.demo;\n\nimport org.apache.commons.lang3.RandomUtils;\n\nimport java.net.InetAddress;\nimport java.time.LocalDateTime;\nimport java.time.ZoneId;\nimport java.time.format.DateTimeFormatter;\nimport java.util.concurrent.atomic.AtomicInteger;\n\npublic class UUIDUtil {\n    private static final AtomicInteger SEQ = new AtomicInteger(1000);\n    private static final DateTimeFormatter DF_FMT_PREFIX = DateTimeFormatter.ofPattern("yyMMddHHmmssSS");\n    private static ZoneId ZONE_ID = ZoneId.of("Asia/Shanghai");//时区\n    private volatile static String IP_SUFFIX = null;//IP前缀\n    public static String generateOrderNo(){\n        LocalDateTime dataTime = LocalDateTime.now(ZONE_ID);\n        if(SEQ.intValue()>9990){\n            SEQ.getAndSet(1000);\n        }\n        return  getLocalIpSuffix()+dataTime.format(DF_FMT_PREFIX)+SEQ.getAndIncrement();\n    }\n    private static String getLocalIpSuffix (){\n        if(null != IP_SUFFIX){\n            return IP_SUFFIX;\n        }\n        try {\n            synchronized (UUIDUtil.class){\n                if(null != IP_SUFFIX){\n                    return IP_SUFFIX;\n                }\n                InetAddress addr = InetAddress.getLocalHost();\n                //  172.17.0.4  172.17.0.199 ,\n                String hostAddress = addr.getHostAddress();\n                if (null != hostAddress && hostAddress.length() > 4) {\n                    String ipSuffix = hostAddress.trim().split("\\\\.")[3];\n                    if (ipSuffix.length() == 2) {\n                        IP_SUFFIX = ipSuffix;\n                        return IP_SUFFIX;\n                    }\n                    ipSuffix = "0" + ipSuffix;\n                    IP_SUFFIX = ipSuffix.substring(ipSuffix.length() - 2);\n                    return IP_SUFFIX;\n                }\n                IP_SUFFIX = RandomUtils.nextInt(10, 20) + "";\n                return IP_SUFFIX;\n            }\n        }catch (Exception e){\n            System.out.println("获取IP失败:"+e.getMessage());\n            IP_SUFFIX =  RandomUtils.nextInt(10,20)+"";\n            return IP_SUFFIX;\n        }\n    }\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br"),a("span",{staticClass:"line-number"},[n._v("32")]),a("br"),a("span",{staticClass:"line-number"},[n._v("33")]),a("br"),a("span",{staticClass:"line-number"},[n._v("34")]),a("br"),a("span",{staticClass:"line-number"},[n._v("35")]),a("br"),a("span",{staticClass:"line-number"},[n._v("36")]),a("br"),a("span",{staticClass:"line-number"},[n._v("37")]),a("br"),a("span",{staticClass:"line-number"},[n._v("38")]),a("br"),a("span",{staticClass:"line-number"},[n._v("39")]),a("br"),a("span",{staticClass:"line-number"},[n._v("40")]),a("br"),a("span",{staticClass:"line-number"},[n._v("41")]),a("br"),a("span",{staticClass:"line-number"},[n._v("42")]),a("br"),a("span",{staticClass:"line-number"},[n._v("43")]),a("br"),a("span",{staticClass:"line-number"},[n._v("44")]),a("br"),a("span",{staticClass:"line-number"},[n._v("45")]),a("br"),a("span",{staticClass:"line-number"},[n._v("46")]),a("br"),a("span",{staticClass:"line-number"},[n._v("47")]),a("br"),a("span",{staticClass:"line-number"},[n._v("48")]),a("br"),a("span",{staticClass:"line-number"},[n._v("49")]),a("br"),a("span",{staticClass:"line-number"},[n._v("50")]),a("br"),a("span",{staticClass:"line-number"},[n._v("51")]),a("br"),a("span",{staticClass:"line-number"},[n._v("52")]),a("br"),a("span",{staticClass:"line-number"},[n._v("53")]),a("br"),a("span",{staticClass:"line-number"},[n._v("54")]),a("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);